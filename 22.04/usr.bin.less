# Author: Simon Deziel
# vim:syntax=apparmor

abi <abi/3.0>,
include <tunables/global>

profile less /usr/bin/less {
  include <abstractions/base>

  capability dac_read_search,

  # prevent "live" decompression or shell exec
  deny /usr/bin/dash x,

  /usr/bin/less rmix,

  # less history
  owner @{HOME}/.lesshst rw,
  owner @{HOME}/.lesshsQ w,

  /** r,

  include if exists <local/usr.bin.less>
}
